# CVE-2020-8492 

Python 2.7 through 2.7.17, 3.5 through 3.5.9, 3.6 through 3.6.10, 3.7 through 3.7.6, and 3.8 through 3.8.1 allows an HTTP server to conduct Regular Expression Denial of Service (ReDoS) attacks against a client because of urllib.request.AbstractBasicAuthHandler catastrophic backtracking.

# PoC

`AbstractBasicAuthHandler()` has a ReDoS vulnerability that can cause backtracking by repeating commas.

- https://github.com/python/cpython/blob/7c4bae4e611cf8c03601ecca93cf6482226c52aa/Lib/urllib/request.py#L940

```python
rx = re.compile('(?:[^,]*,)*[ \t]*([^ \t]+)[ \t]+'
                    'realm=(["\']?)([^"\']*)\\2', re.I)

...

mo = AbstractBasicAuthHandler.rx.search(authreq)
```

This PoC shows that it takes 2 seconds for 20 commas, and 6 seconds for 22 commas.

```python
# ',' * 20
❯ time python poc.py
        2.25 real         1.62 user         0.15 sys

# ',' * 22
❯ time python poc.py
       10.92 real         6.72 user         0.20 sys
```

# References

- https://bugs.python.org/issue39503
- https://github.com/python/cpython/pull/18284
- https://python-security.readthedocs.io/vuln/urllib-basic-auth-regex.html
